"use strict";(self["webpackChunkmappitweb"]=self["webpackChunkmappitweb"]||[]).push([[7575],{58322:function(e,t,r){r.d(t,{F:function(){return _}});var s=r(94848),o=r(8693),i=r(80060),a=r(33482),n=r(60317),l=r(16829),u=r(61445),p=r(39264),c=r(60931),f=r(58006),d=(r(15055),r(81653),r(94315),r(62269)),y=r(77623),m=r(48169),g=r(47696),b=r(88833);let v=class extends c.wq{constructor(e){super(e),this.directionLines=null,this.directionPoints=null,this.directions=null,this.route=null,this.routeName=null,this.stops=null}};(0,u._)([(0,f.Cb)({type:m["default"],json:{write:!0}})],v.prototype,"directionLines",void 0),(0,u._)([(0,f.Cb)({type:m["default"],json:{write:!0}})],v.prototype,"directionPoints",void 0),(0,u._)([(0,f.Cb)({type:b.Z,json:{write:!0}})],v.prototype,"directions",void 0),(0,u._)([(0,f.Cb)({type:p.Z,json:{write:!0}})],v.prototype,"route",void 0),(0,u._)([(0,f.Cb)({type:String,json:{write:!0}})],v.prototype,"routeName",void 0),(0,u._)([(0,f.Cb)({type:[p.Z],json:{write:!0}})],v.prototype,"stops",void 0),v=(0,u._)([(0,y.j)("esri.rest.support.RouteResult")],v);const h=v;function B(e){return e&&m["default"].fromJSON(e).features.map((e=>e))}let R=class extends c.wq{constructor(e){super(e),this.messages=null,this.pointBarriers=null,this.polylineBarriers=null,this.polygonBarriers=null,this.routeResults=null}readPointBarriers(e,t){return B(t.barriers)}readPolylineBarriers(e){return B(e)}readPolygonBarriers(e){return B(e)}};(0,u._)([(0,f.Cb)({type:[g.Z]})],R.prototype,"messages",void 0),(0,u._)([(0,f.Cb)({type:[p.Z]})],R.prototype,"pointBarriers",void 0),(0,u._)([(0,d.r)("pointBarriers",["barriers"])],R.prototype,"readPointBarriers",null),(0,u._)([(0,f.Cb)({type:[p.Z]})],R.prototype,"polylineBarriers",void 0),(0,u._)([(0,d.r)("polylineBarriers")],R.prototype,"readPolylineBarriers",null),(0,u._)([(0,f.Cb)({type:[p.Z]})],R.prototype,"polygonBarriers",void 0),(0,u._)([(0,d.r)("polygonBarriers")],R.prototype,"readPolygonBarriers",null),(0,u._)([(0,f.Cb)({type:[h]})],R.prototype,"routeResults",void 0),R=(0,u._)([(0,y.j)("esri.rest.support.RouteSolveResult")],R);const A=R,N=(0,i.E)({accumulateAttributes:{name:"accumulateAttributeNames"},attributeParameterValues:!0,directionsTimeAttribute:{name:"directionsTimeAttributeName"},impedanceAttribute:{name:"impedanceAttributeName"},outSpatialReference:{name:"outSR",getter:e=>e.outSpatialReference.wkid},pointBarriers:{name:"barriers"},polylineBarriers:!0,polygonBarriers:!0,restrictionAttributes:{name:"restrictionAttributeNames"},stops:!0,travelMode:!0});function w(e){return"esri.rest.support.FeatureSet"===(null==e?void 0:e.declaredClass)}async function _(e,t,r){const o=[],i=[],u={},p={},c=(0,l.en)(e),{path:f}=c;w(t.stops)&&(0,n.et)(t.stops.features,i,"stops.features",u),w(t.pointBarriers)&&(0,n.et)(t.pointBarriers.features,i,"pointBarriers.features",u),w(t.polylineBarriers)&&(0,n.et)(t.polylineBarriers.features,i,"polylineBarriers.features",u),w(t.polygonBarriers)&&(0,n.et)(t.polygonBarriers.features,i,"polygonBarriers.features",u);const d=await(0,a.aX)(i);for(const s in u){const e=u[s];o.push(s),p[s]=d.slice(e[0],e[1])}if((0,n.Wf)(p,o)){let e=null;try{e=await(0,n.bI)(f,t.apiKey,r)}catch{}e&&!e.hasZ&&(0,n.ef)(p,o)}for(const s in p)p[s].forEach(((e,r)=>{t.get(s)[r].geometry=e}));const y={...r,query:{...c.query,...N.toQueryParams(t),f:"json"}},m=f.endsWith("/solve")?f:`${f}/solve`,{data:g}=await(0,s["default"])(m,y);return C(g)}function C(e){var t,r,s,i,a;const n=new Map,{directionLines:l,directionPoints:u,directions:p,routes:c,stops:f,barriers:d,polygonBarriers:y,polylineBarriers:m,messages:g}=e,b=null!=(t=null!=(r=null!=(s=null!=(i=null==c?void 0:c.spatialReference)?i:null==f?void 0:f.spatialReference)?s:null==d?void 0:d.spatialReference)?r:null==y?void 0:y.spatialReference)?t:null==m?void 0:m.spatialReference;null==c||c.features.forEach((e=>{const t=e.attributes.Name,r=e.attributes.ObjectID;n.has(t)?(n.get(t).route=e,n.get(t).routeId=r):n.set(t,{route:e,routeId:r,routeName:t}),(0,o.pC)(e.geometry)&&(e.geometry.spatialReference=b)})),null==p||p.forEach((e=>{const t=e.routeName;n.has(t)?n.get(t).directions=e:n.set(t,{routeName:t,directions:e})})),null==f||f.features.forEach((e=>{var t;const r=null!=(t=e.attributes.RouteName)?t:null;n.has(r)?n.get(r).stops?n.get(r).stops.push(e):n.get(r).stops=[e]:n.set(r,{stops:[e],routeName:r}),(0,o.pC)(e.geometry)&&(e.geometry.spatialReference=b)}));const v=null==(a=null==f?void 0:f.features.every((e=>null==e.attributes.RouteName)))||a;if((null==f?void 0:f.features.length)>0&&v){const e=Array.from(n.keys())[0];n.get(e).stops=n.get(null).stops,n.delete(null)}null==l||l.features.forEach((e=>{var t;const r=e.attributes.RouteID,s=null==(t=Array.from(n.values()).find((e=>e.routeId===r)))?void 0:t.routeName;if(s)if(n.has(s))if(n.get(s).directionLines)n.get(s).directionLines.features.push(e);else{const{fieldAliases:t,geometryType:r,spatialReference:o}=l;n.get(s).directionLines={features:[e],fieldAliases:t,geometryType:r,spatialReference:o}}else{const{fieldAliases:t,geometryType:r,spatialReference:o}=l;n.set(s,{routeName:s,directionLines:{features:[e],fieldAliases:t,geometryType:r,spatialReference:o}})}})),null==u||u.features.forEach((e=>{var t;const r=e.attributes.RouteID,s=null==(t=Array.from(n.values()).find((e=>e.routeId===r)))?void 0:t.routeName;if(s)if(n.has(s))if(n.get(s).directionPoints)n.get(s).directionPoints.features.push(e);else{const{fieldAliases:t,geometryType:r,spatialReference:o}=u;n.get(s).directionPoints={features:[e],fieldAliases:t,geometryType:r,spatialReference:o}}else{const{fieldAliases:t,geometryType:r,spatialReference:o}=u;n.set(s,{routeName:s,directionPoints:{features:[e],fieldAliases:t,geometryType:r,spatialReference:o}})}}));const h=Array.from(n.values());return A.fromJSON({routeResults:h,barriers:d,polygonBarriers:y,polylineBarriers:m,messages:g})}},47575:function(e,t,r){r.r(t),r.d(t,{default:function(){return l}});var s=r(61445),o=(r(93622),r(94315),r(15055),r(81653),r(10771),r(77623)),i=r(58322),a=r(60672);let n=class extends a.Z{constructor(e){super(e)}solve(e,t){return(0,i.F)(this.url,e,t)}};n=(0,s._)([(0,o.j)("esri.tasks.RouteTask")],n);const l=n}}]);
//# sourceMappingURL=7575.e3973a8c.js.map