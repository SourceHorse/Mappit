"use strict";(self["webpackChunkmappitweb"]=self["webpackChunkmappitweb"]||[]).push([[4143],{45982:function(t,e,n){n.d(e,{BH:function(){return M},K:function(){return V},KC:function(){return g},NL:function(){return h},QI:function(){return w},Tg:function(){return d},Yx:function(){return u},nb:function(){return T},wF:function(){return L},xQ:function(){return m}});n(48675),n(3462);var r=n(38511),o=n(8693),i=n(54065),a=n(46814);const s=new Map;s.set("meter-per-second",1),s.set("kilometer-per-hour",.277778),s.set("knots",.514444),s.set("feet-per-second",.3048),s.set("mile-per-hour",.44704);const l=180/Math.PI,c=5,h=new r.X({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"});function u(t,e){return s.get(t)/s.get(e)||1}function f(t){return(450-t)%360}function d(t,e="geographic"){const[n,r]=t,o=Math.sqrt(n*n+r*r);let i=Math.atan2(r,n)*l;return i=(360+i)%360,"geographic"===e&&(i=f(i)),[o,i]}function p(t,e="geographic"){let n=t[1];"geographic"===e&&(n=f(n)),n%=360;const r=t[0];return[r*Math.cos(n/l),r*Math.sin(n/l)]}function m(t,e,n,r="geographic"){if(!(0,a.nk)(t)||(0,o.Wi)(n))return t;const i="vector-magdir"===e?t.clone():(0,o.Wg)(g(t,e)),s=i.pixels[1];for(let o=0;o<s.length;o++)s[o]="geographic"===r?(s[o]+n[o]+270)%360:(s[o]+360-n[o])%360;return"vector-magdir"===e?i:g(i,"vector-magdir")}function g(t,e,n="geographic",r=1){if(!(0,a.nk)(t))return t;const{pixels:o,width:s,height:l}=t,c=s*l,h=o[0],u=o[1],f=t.pixelType.startsWith("f")?t.pixelType:"f32",m=i.Z.createEmptyBand(f,c),g=i.Z.createEmptyBand(f,c);let w=0;for(let i=0;i<l;i++)for(let t=0;t<s;t++)"vector-uv"===e?([m[w],g[w]]=d([h[w],u[w]],n),m[w]*=r):([m[w],g[w]]=p([h[w],u[w]],n),m[w]*=r,g[w]*=r),w++;const M=new i.Z({pixelType:f,width:t.width,height:t.height,mask:t.mask,validPixelCount:t.validPixelCount,maskIsAlpha:t.maskIsAlpha,pixels:[m,g]});return M.updateStatistics(),M}function w(t,e,n=1){if(1===n||!(0,a.nk)(t))return t;const r=t.clone(),{pixels:o,width:i,height:s}=r,l=o[0],c=o[1];let h=0;for(let a=0;a<s;a++)for(let t=0;t<i;t++)"vector-uv"===e?(l[h]*=n,c[h]*=n):l[h]*=n,h++;return r.updateStatistics(),r}function M(t,e,n,r,i){if(!(0,o.pC)(i)||!i.spatialReference.equals(t.spatialReference))return{extent:t,width:Math.round(e/r),height:Math.round(n/r),resolution:t.width/e};const a=i.xmin,s=i.ymax,l=(t.xmax-t.xmin)/e*r,c=(t.ymax-t.ymin)/n*r,h=(l+c)/2;return t.xmin=a+Math.floor((t.xmin-a)/l)*l,t.xmax=a+Math.ceil((t.xmax-a)/l)*l,t.ymin=s+Math.floor((t.ymin-s)/c)*c,t.ymax=s+Math.ceil((t.ymax-s)/c)*c,{extent:t,width:Math.round(t.width/l),height:Math.round(t.height/c),resolution:h}}const x=y(0,0,0);function y(t=0,e=0,n=Math.PI,r=!0){r&&(n=(2*Math.PI-n)%(2*Math.PI));const o=r?-1:1,i=13*o,a=-7*o,s=-2*o,l=-16*o,c=21.75,[h,u]=v(0,e+i,n,c),[f,d]=v(t-5.5,e+a,n,c),[p,m]=v(t+5.5,e+a,n,c),[g,w]=v(t-1.5,e+s,n,c),[M,x]=v(t+1.5,e+s,n,c),[y,k]=v(t-1.5,e+l,n,c),[P,b]=v(t+1.5,e+l,n,c);return[h,u,f,d,g,w,M,x,p,m,y,k,P,b]}function k(t=0,e=Math.PI,n=!0){n&&(e=(2*Math.PI-e)%(2*Math.PI));const r=10,o=n?-1:1,i=5*o,a=20*o,s=25*o,l=45,h=0,u=0,f=2,d=0,p=f*o;let[m,g]=[h+r/2,u-a],[w,M]=[m+f,g],[x,y]=[w-d,M+p],[k,P]=[h-r/2,u-s],[b,A]=[k+d,P-p],I=Math.ceil(t/c),F=Math.floor(I/10);I-=8*F;const S=[],_=[];for(let c=0;c<I/2;c++,F--){F<=0&&I%2==1&&c===(I-1)/2&&(k=h,b=k+d,P=(P+g)/2,A=P-p);const[t,n]=v(k,P,e,l);if(F>0){const[r,o]=v(w,P,e,l),[i,a]=v(m,g,e,l);S.push(r),S.push(o),S.push(t),S.push(n),S.push(i),S.push(a)}else{const[r,o]=v(w,M,e,l),[i,a]=v(x,y,e,l),[s,c]=v(b,A,e,l);_.push(t),_.push(n),_.push(s),_.push(c),_.push(i),_.push(a),_.push(r),_.push(o)}P+=i,g+=i,M+=i,y+=i,A+=i}const[D,V]=v(h+r/2,u+a,e,l),L=r/2+f,[T,U]=v(h+L,u+a,e,l),[C,q]=v(h+r/2,u-s,e,l),[O,Z]=v(h+L,u-s,e,l);return{pennants:S,barbs:_,shaft:[D,V,T,U,C,q,O,Z]}}function v(t,e,n,r=1){const o=Math.sqrt(t*t+e*e)/r,i=(2*Math.PI+Math.atan2(e,t))%(2*Math.PI);return[o,(2*Math.PI+i-n)%(2*Math.PI)]}const P=[0,1,3,6,10,16,21,27,33,40,47,55,63],b=[0,.5,1,1.5,2],A=[0,.25,.5,1,1.5,2,2.5,3,3.5,4];function I(t,e,n,r){const o=u(r||"knots",n);let i;for(i=1;i<e.length;i++)if(i===e.length-1){if(t<e[i]*o)break}else if(t<=e[i]*o)break;return Math.min(i-1,e.length-2)}function F(t,e,n,r,o){let i=0;switch(e){case"beaufort_kn":i=I(t,P,"knots",n);break;case"beaufort_km":i=I(t,P,"kilometer-per-hour",n);break;case"beaufort_ft":i=I(t,P,"feet-per-second",n);break;case"beaufort_m":i=I(t,P,"meter-per-second",n);break;case"classified_arrow":i=I(t,o,r,n);break;case"ocean_current_m":i=I(t,b,"meter-per-second",n);break;case"ocean_current_kn":i=I(t,A,"knots",n)}return i}function S(t,e){const{style:n,inputUnit:r,outputUnit:o,breakValues:i}=e,a=h.fromJSON(r),s=h.fromJSON(o),l=42,c=15;let u=0,f=0;const{width:d,height:p,mask:m}=t,g=t.pixels[0],w=t.pixels[1],M=m?m.filter((t=>t>0)).length:d*p,y=new Float32Array(M*l),k=new Uint32Array(c*M);for(let h=0;h<p;h++)for(let t=0;t<d;t++){const e=h*d+t;if(!m||m[h*d+t]){var v;const r=null!=(v=(w[e]+360)%360/180*Math.PI)?v:2*Math.PI*Math.random(),o=F(g[e],n,a,s,i);for(let n=0;n<x.length;n+=2)y[u++]=(t+.5)/d,y[u++]=(h+.5)/p,y[u++]=x[n],y[u++]=x[n+1]+r,y[u++]=o,y[u++]=g[e];const c=7*(u/l-1);k[f++]=c,k[f++]=c+1,k[f++]=c+2,k[f++]=c+0,k[f++]=c+4,k[f++]=c+3,k[f++]=c+0,k[f++]=c+2,k[f++]=c+3,k[f++]=c+2,k[f++]=c+5,k[f++]=c+3,k[f++]=c+5,k[f++]=c+6,k[f++]=c+3}}return{vertexData:y,indexData:k}}const _=[];function D(t,e){if(0===_.length)for(let c=0;c<30;c++)_.push(k(5*c,0));const n=u(h.fromJSON(e.inputUnit),"knots"),{width:r,height:o,mask:i}=t,a=t.pixels[0],s=t.pixels[1],l=6,f=[],d=[];let p=0,m=0;for(let h=0;h<o;h++)for(let t=0;t<r;t++){const e=h*r+t,u=a[e]*n;if((!i||i[h*r+t])&&u>=c){var g;const n=null!=(g=(s[e]+360)%360/180*Math.PI)?g:2*Math.PI*Math.random(),{pennants:i,barbs:a,shaft:c}=_[Math.min(Math.floor(u/5),29)];if(i.length+a.length===0)continue;let w=f.length/l;const M=(t+.5)/r,x=(h+.5)/o;for(let t=0;t<i.length;t+=2)f[p++]=M,f[p++]=x,f[p++]=i[t],f[p++]=i[t+1]+n,f[p++]=0,f[p++]=u;for(let t=0;t<a.length;t+=2)f[p++]=M,f[p++]=x,f[p++]=a[t],f[p++]=a[t+1]+n,f[p++]=0,f[p++]=u;for(let t=0;t<c.length;t+=2)f[p++]=M,f[p++]=x,f[p++]=c[t],f[p++]=c[t+1]+n,f[p++]=0,f[p++]=u;for(let t=0;t<i.length/6;t++)d[m++]=w,d[m++]=w+1,d[m++]=w+2,w+=3;for(let t=0;t<a.length/8;t++)d[m++]=w,d[m++]=w+1,d[m++]=w+2,d[m++]=w+1,d[m++]=w+2,d[m++]=w+3,w+=4;d[m++]=w+0,d[m++]=w+1,d[m++]=w+2,d[m++]=w+1,d[m++]=w+3,d[m++]=w+2,w+=4}}return{vertexData:new Float32Array(f),indexData:new Uint32Array(d)}}function V(t,e){const n=24;let r=0,o=0;const{width:i,height:a,mask:s}=t,l=t.pixels[0],f=[],d=[],p=u(h.fromJSON(e.inputUnit),"knots"),m="wind_speed"===e.style?c:Number.MAX_VALUE;for(let c=0;c<a;c++)for(let t=0;t<i;t++){const e=l[c*i+t]*p;if((!s||s[c*i+t])&&e<m){for(let n=0;n<4;n++)f[r++]=(t+.5)/i,f[r++]=(c+.5)/a,f[r++]=n<2?-.5:.5,f[r++]=n%2==0?-.5:.5,f[r++]=0,f[r++]=e;const s=4*(r/n-1);d[o++]=s,d[o++]=s+1,d[o++]=s+2,d[o++]=s+1,d[o++]=s+2,d[o++]=s+3}}return{vertexData:new Float32Array(f),indexData:new Uint32Array(d)}}function L(t,e){return"simple_scalar"===e.style?V(t,e):"wind_speed"===e.style?D(t,e):S(t,e)}function T(t,e,n,r=[0,0],o=.5){const{width:a,height:s,mask:l}=t,[c,h]=t.pixels,[u,f]=r,m=Math.round((a-u)/n),g=Math.round((s-f)/n),w=m*g,M=new Float32Array(w),x=new Float32Array(w),y=new Uint8Array(w),k="vector-uv"===e;for(let i=0;i<g;i++)for(let t=0;t<m;t++){let e=0;const r=i*m+t,g=Math.max(0,i*n+f),w=Math.max(0,t*n+u),v=Math.min(s,g+n),P=Math.min(a,w+n);for(let t=g;t<v;t++)for(let n=w;n<P;n++){const o=t*a+n;if(!l||l[o]){e++;const t=k?[c[o],h[o]]:[c[o],(360+h[o])%360],[n,i]=k?t:p(t);M[r]+=n,x[r]+=i}}if(e>=(v-g)*(P-w)*(1-o)){y[r]=1;const[t,n]=d([M[r]/e,x[r]/e]);M[r]=t,x[r]=n}else y[r]=0,M[r]=0,x[r]=0}const v=new i.Z({width:m,height:g,pixels:[M,x],mask:y});return v.updateStatistics(),v}},66224:function(t,e,n){n.d(e,{KK:function(){return y},z_:function(){return f}});n(48675),n(3462),n(80388);var r=n(93622),o=n(67752),i=n(8693),a=n(92454),s=n(12840),l=n(54597),c=n(50157);const h=r.Z.getLogger("esri.views.2d.engine.flow.dataUtils"),u=9;async function f(t,e,n){const r=performance.now(),o=d(t,e),i=performance.now(),s=m(t,o,e.width,e.height),l=performance.now(),c=w(s,!0),u=performance.now(),f=M(c),p=performance.now();if(t.profile){const t={"_createFlowFieldFromData()":Math.round(i-r),"_getStreamlines()":Math.round(l-i),"createAnimatedLinesData()":Math.round(u-l),"createLinesMesh()":Math.round(p-u),"Total elapsed time":Math.round(p-r)};h.info("createStreamlinesMesh profile",t)}return await Promise.resolve(),(0,a.k_)(n),f}function d(t,e){const n=g(e.data,e.width,e.height,t.smoothing);return t.interpolate?(t,r)=>{const o=Math.floor(t),i=Math.floor(r);if(o<0||o>=e.width)return[0,0];if(i<0||i>=e.height)return[0,0];const a=t-o,s=r-i,l=o,c=i,h=o<e.width-1?o+1:o,u=i<e.height-1?i+1:i,f=n[2*(c*e.width+l)],d=n[2*(c*e.width+h)],p=n[2*(u*e.width+l)],m=n[2*(u*e.width+h)],g=n[2*(c*e.width+l)+1],w=n[2*(c*e.width+h)+1];return[(f*(1-s)+p*s)*(1-a)+(d*(1-s)+m*s)*a,(g*(1-s)+n[2*(u*e.width+l)+1]*s)*(1-a)+(w*(1-s)+n[2*(u*e.width+h)+1]*s)*a]}:(t,r)=>{const o=Math.round(t),i=Math.round(r);return o<0||o>=e.width||i<0||i>=e.height?[0,0]:[n[2*(i*e.width+o)+0],n[2*(i*e.width+o)+1]]}}function p(t,e,n,r,o,i,a,s,l){const c=[];let h=n,u=r,f=0,[d,p]=e(h,u);d*=t.velocityScale,p*=t.velocityScale;const m=Math.sqrt(d*d+p*p);let g,w;c.push({x:h,y:u,t:f,speed:m});for(let M=0;M<t.verticesPerLine;M++){let[n,r]=e(h,u);n*=t.velocityScale,r*=t.velocityScale;const d=Math.sqrt(n*n+r*r);if(d<t.minSpeedThreshold)return c;const p=n/d,m=r/d;if(h+=p*t.segmentLength,u+=m*t.segmentLength,f+=t.segmentLength/d,Math.acos(p*g+m*w)>t.maxTurnAngle)return c;if(t.mergeLines){const t=Math.round(h*l),e=Math.round(u*l);if(t<0||t>a-1||e<0||e>s-1)return c;const n=i[e*a+t];if(-1!==n&&n!==o)return c;i[e*a+t]=o}c.push({x:h,y:u,t:f,speed:d}),g=p,w=m}return c}function m(t,e,n,r){const o=[],i=new s.Z,a=1/Math.max(t.lineCollisionWidth,1),l=Math.round(n*a),c=Math.round(r*a),h=new Int32Array(l*c);for(let s=0;s<h.length;s++)h[s]=-1;const u=[];for(let s=0;s<r;s+=t.lineSpacing)for(let e=0;e<n;e+=t.lineSpacing)u.push({x:e,y:s,sort:i.getFloat()});u.sort(((t,e)=>t.sort-e.sort));for(const{x:s,y:f}of u)if(i.getFloat()<t.density){const n=p(t,e,s,f,o.length,h,l,c,a);if(n.length<2)continue;o.push(n)}return o}function g(t,e,n,r){if(0===r)return t;const o=Math.round(3*r),i=new Array(2*o+1);let a=0;for(let c=-o;c<=o;c++){const t=Math.exp(-c*c/(r*r));i[c+o]=t,a+=t}for(let c=-o;c<=o;c++)i[c+o]/=a;const s=new Float32Array(t.length);for(let c=0;c<n;c++)for(let n=0;n<e;n++){let r=0,a=0;for(let s=-o;s<=o;s++){if(n+s<0||n+s>=e)continue;const l=i[s+o];r+=l*t[2*(c*e+(n+s))+0],a+=l*t[2*(c*e+(n+s))+1]}s[2*(c*e+n)+0]=r,s[2*(c*e+n)+1]=a}const l=new Float32Array(t.length);for(let c=0;c<e;c++)for(let t=0;t<n;t++){let r=0,a=0;for(let l=-o;l<=o;l++){if(t+l<0||t+l>=n)continue;const h=i[l+o];r+=h*s[2*((t+l)*e+c)+0],a+=h*s[2*((t+l)*e+c)+1]}l[2*(t*e+c)+0]=r,l[2*(t*e+c)+1]=a}return l}function w(t,e){const n=new s.Z,r=t.reduce(((t,e)=>t+e.length),0),o=new Float32Array(4*r),i=new Array(t.length);let a=0,l=0;for(const s of t){const t=a;for(const e of s)o[4*a+0]=e.x,o[4*a+1]=e.y,o[4*a+2]=e.t,o[4*a+3]=e.speed,a++;i[l++]={startVertex:t,numberOfVertices:s.length,totalTime:s[s.length-1].t,timeSeed:e?n.getFloat():0}}return{lineVertices:o,lineDescriptors:i}}function M(t,e=10){const{lineVertices:n,lineDescriptors:r}=t;let o=0,i=0;for(const u of r)o+=2*u.numberOfVertices,i+=6*(u.numberOfVertices-1);const a=new Float32Array(o*u),s=new Uint32Array(i);let l=0,c=0;function h(){s[c++]=l-2,s[c++]=l,s[c++]=l-1,s[c++]=l,s[c++]=l+1,s[c++]=l-1}function f(t,e,n,r,o,i,s,c){const h=l*u;let f=0;a[h+f++]=t,a[h+f++]=e,a[h+f++]=1,a[h+f++]=n,a[h+f++]=i,a[h+f++]=s,a[h+f++]=r/2,a[h+f++]=o/2,a[h+f++]=c,l++,a[h+f++]=t,a[h+f++]=e,a[h+f++]=-1,a[h+f++]=n,a[h+f++]=i,a[h+f++]=s,a[h+f++]=-r/2,a[h+f++]=-o/2,a[h+f++]=c,l++}for(const u of r){const{totalTime:t,timeSeed:r}=u;let o=null,i=null,a=null,s=null,l=null,c=null;for(let d=0;d<u.numberOfVertices;d++){const p=n[4*(u.startVertex+d)+0],m=n[4*(u.startVertex+d)+1],g=n[4*(u.startVertex+d)+2],w=n[4*(u.startVertex+d)+3];let M=null,x=null,y=null,k=null;if(d>0){M=p-o,x=m-i;const n=Math.sqrt(M*M+x*x);if(M/=n,x/=n,d>1){let t=M+l,n=x+c;const r=Math.sqrt(t*t+n*n);t/=r,n/=r;const o=Math.min(1/(t*M+n*x),e);t*=o,n*=o,y=-n,k=t}else y=-x,k=M;null!==y&&null!==k&&(f(o,i,a,y,k,t,r,w),h())}o=p,i=m,a=g,l=M,c=x,s=w}f(o,i,a,-c,l,t,r,s)}return{vertexData:a,indexData:s}}function x(t,e){const n=e.pixels,{width:r,height:i}=e,a=new Float32Array(r*i*2);if("vector-uv"===t)for(let o=0;o<r*i;o++)a[2*o+0]=n[0][o],a[2*o+1]=-n[1][o];else if("vector-magdir"===t)for(let s=0;s<r*i;s++){const t=n[0][s],e=(0,o.Vl)(n[1][s]),r=Math.cos(e-Math.PI/2),i=Math.sin(e-Math.PI/2);a[2*s+0]=r*t,a[2*s+1]=i*t}return{data:a,width:r,height:i}}async function y(t,e,n,r,o,i){const a=(0,l.C5)(e.spatialReference);if(!a)return k(t,e,n,r,o,i);const[s,h]=a.valid,u=h-s,f=Math.ceil(e.width/u),d=e.width/f,p=Math.round(n/f);let m=e.xmin;const g=[];for(let l=0;l<f;l++){const n=new c.Z({xmin:m,xmax:m+d,ymin:e.ymin,ymax:e.ymax,spatialReference:e.spatialReference});g.push(k(t,n,p,r,o,i)),m+=d}const w=await Promise.all(g),M={data:new Float32Array(n*r*2),width:n,height:r};let x=0;for(const l of w){for(let t=0;t<l.height;t++)for(let e=0;e<l.width;e++)x+e>=n||(M.data[2*(t*n+x+e)+0]=l.data[2*(t*l.width+e)+0],M.data[2*(t*n+x+e)+1]=l.data[2*(t*l.width+e)+1]);x+=l.width}return M}async function k(t,e,n,r,o,a){const s={requestProjectedLocalDirections:!0,signal:a};if((0,i.pC)(o)&&(s.timeExtent=o),"imagery"===t.type){await t.load({signal:a});const o=t.rasterInfo.dataType,l=await t.fetchImage(e,n,r,s);return!l||(0,i.Wi)(l.pixelData)||(0,i.Wi)(l.pixelData.pixelBlock)?{data:new Float32Array(n*r*2),width:n,height:r}:x(o,l.pixelData.pixelBlock)}await t.load({signal:a});const l=t.rasterInfo.dataType,c=await t.fetchPixels(e,n,r,s);return!c||(0,i.Wi)(c.pixelBlock)?{data:new Float32Array(n*r*2),width:n,height:r}:x(l,c.pixelBlock)}}}]);
//# sourceMappingURL=4143.66850768.js.map